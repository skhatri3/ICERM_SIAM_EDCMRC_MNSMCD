(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48247,       1154]
NotebookOptionsPosition[     44259,       1081]
NotebookOutlinePosition[     44730,       1099]
CellTagsIndexPosition[     44687,       1096]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This is my attempt to create the 3D version of the exact solution in Section \
3.1, Cortez et al. Fluids 2021\
\>", "Text",
 CellChangeTimes->{{3.9431184679153433`*^9, 
  3.943118508295968*^9}},ExpressionUUID->"a43b5442-a45a-4413-b6df-\
b22d03276a2d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", ">", "0"}], ",", 
     RowBox[{"R", ">", "0"}], ",", 
     RowBox[{"r", ">", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"2", "D", " ", "Bsingular"}], "=", 
    RowBox[{
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", "r", "]"}], "-", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", "*", "Pi"}], ")"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"2", "D", " ", "Gsingular"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", "r", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "Pi"}], ")"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Bsingular", "=", 
  RowBox[{
   RowBox[{"-", "r"}], "/", 
   RowBox[{"(", 
    RowBox[{"8", "*", "Pi"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Gsingular", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", "1"}], "/", 
   RowBox[{"(", 
    RowBox[{"4", "*", "Pi", "*", "r"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.59102329750277*^9, 3.5910233077325177`*^9}, {
  3.59135824949691*^9, 3.5913582905174017`*^9}, {3.591359436690371*^9, 
  3.591359494528225*^9}, {3.942250347927515*^9, 3.9422504300338564`*^9}, {
  3.943118514366289*^9, 3.943118514753764*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"dd7fd2bb-c35b-420d-a2a2-308ab2b5a6ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", ">", "0"}], ",", 
   RowBox[{"R", ">", "0"}], ",", 
   RowBox[{"r", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5910233081780233`*^9, 3.591355850791958*^9, 3.591358181141249*^9, {
   3.591358270722426*^9, 3.591358290959609*^9}, 3.59135838137521*^9, 
   3.5913588848880153`*^9, {3.5913594275633307`*^9, 3.591359451955329*^9}, {
   3.591359495719154*^9, 3.591359504861133*^9}, 3.5913615535408497`*^9, 
   3.591366363905018*^9, 3.5913667093818817`*^9, 3.591368215987702*^9, 
   3.591372258263839*^9, 3.5915293455387793`*^9, 3.591530934984655*^9, 
   3.591534571370042*^9, {3.591722061691664*^9, 3.591722066962728*^9}, 
   3.939228325942549*^9, 3.942250432690352*^9, 3.942251802278654*^9, 
   3.942252467870781*^9, 3.942252605056798*^9, 3.942256149846519*^9, 
   3.942256564316955*^9, 3.9422572616986933`*^9, 3.942257571735121*^9, 
   3.943118515038192*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"248b8735-80e2-4512-9a0a-3c39acb0e39c"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["r", 
   RowBox[{"8", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{
  3.5910233081780233`*^9, 3.591355850791958*^9, 3.591358181141249*^9, {
   3.591358270722426*^9, 3.591358290959609*^9}, 3.59135838137521*^9, 
   3.5913588848880153`*^9, {3.5913594275633307`*^9, 3.591359451955329*^9}, {
   3.591359495719154*^9, 3.591359504861133*^9}, 3.5913615535408497`*^9, 
   3.591366363905018*^9, 3.5913667093818817`*^9, 3.591368215987702*^9, 
   3.591372258263839*^9, 3.5915293455387793`*^9, 3.591530934984655*^9, 
   3.591534571370042*^9, {3.591722061691664*^9, 3.591722066962728*^9}, 
   3.939228325942549*^9, 3.942250432690352*^9, 3.942251802278654*^9, 
   3.942252467870781*^9, 3.942252605056798*^9, 3.942256149846519*^9, 
   3.942256564316955*^9, 3.9422572616986933`*^9, 3.942257571735121*^9, 
   3.9431185150390673`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"5b2bd135-bbba-465b-a3e8-afd3d675f6d8"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}]], "Output",
 CellChangeTimes->{
  3.5910233081780233`*^9, 3.591355850791958*^9, 3.591358181141249*^9, {
   3.591358270722426*^9, 3.591358290959609*^9}, 3.59135838137521*^9, 
   3.5913588848880153`*^9, {3.5913594275633307`*^9, 3.591359451955329*^9}, {
   3.591359495719154*^9, 3.591359504861133*^9}, 3.5913615535408497`*^9, 
   3.591366363905018*^9, 3.5913667093818817`*^9, 3.591368215987702*^9, 
   3.591372258263839*^9, 3.5915293455387793`*^9, 3.591530934984655*^9, 
   3.591534571370042*^9, {3.591722061691664*^9, 3.591722066962728*^9}, 
   3.939228325942549*^9, 3.942250432690352*^9, 3.942251802278654*^9, 
   3.942252467870781*^9, 3.942252605056798*^9, 3.942256149846519*^9, 
   3.942256564316955*^9, 3.9422572616986933`*^9, 3.942257571735121*^9, 
   3.943118515039487*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"5931b11f-86d3-498b-bd65-1e2f3b44a515"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"blob", " ", "=", " ", 
   RowBox[{"15", 
    RowBox[{
     RowBox[{"d", "^", "4"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", "Pi", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{"d", "^", "2"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"7", "/", "2"}], ")"}]}]}], ")"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"3", "D", " ", "blob"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"blob", " ", "=", " ", 
    RowBox[{"2", "*", 
     RowBox[{"d", "^", "4"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"d", "^", "2"}]}], "-", 
        RowBox[{"r", "^", "2"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"Pi", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "^", "2"}], "+", 
           RowBox[{"d", "^", "2"}]}], ")"}], "^", "4"}]}], ")"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"2", "*", "Pi", "*", 
    RowBox[{"r", "^", "2"}], "*", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", "blob"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "Infinity"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "^", "3"}], "*", "blob"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "Infinity"}], "}"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQzWK9NzL04CvHUA7BKBD9SN+0A0S/EI3rAdFPwjJ/
hAHpyAu+v0H0k6iV0uFAumMKmzqIvhP0dd13IF2SKbgVRJd6O678AaRlJvuC
6Xl/nt8F0VusP4LpQP1a059A+tAtAwsQveNlRTmInjDlO5h2EMmZCKI59l8C
01fLpReA6GkqO5eC6CideU2/gHTKd9NmEF2T9FLoN5AO++8kDKIflXtag2g9
xh9gWmVO4cI/QFrs8A8wrXH19YG/QPrzifsHQXRL92fN/0A6+X2/Fohm6Fu9
C0TP64rdDaL5V+wx9T30yrE4TN0MRDPMu/fbD0iHuWv8AdE3Jic/tIt/67jv
T8czEN0WvoHLHkhzrasUAtEANgzN+Q==
  "],
 CellLabel->"In[11]:=",ExpressionUUID->"aaed460f-285d-47fe-bcc7-14eb7d858fe4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", 
   SuperscriptBox["d", "4"]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.591023692609852*^9, 3.591023715355994*^9}, {
   3.591026636609727*^9, 3.591026661270802*^9}, {3.591026940689095*^9, 
   3.591027001237807*^9}, {3.59135577018153*^9, 3.5913558170522633`*^9}, 
   3.591355852691101*^9, 3.591357771728786*^9, {3.59135818327808*^9, 
   3.59135819327138*^9}, 3.591358383227811*^9, {3.591358908132207*^9, 
   3.591358914317967*^9}, 3.591359424326515*^9, 3.591359507047414*^9, 
   3.591359633335654*^9, {3.5913597682488194`*^9, 3.5913597905044193`*^9}, 
   3.591361562915642*^9, 3.591362715401692*^9, 3.591363041791689*^9, 
   3.591365836067414*^9, 3.591365905055159*^9, 3.591366363971489*^9, 
   3.5913667094460287`*^9, 3.591368216052421*^9, 3.591371093835653*^9, 
   3.591372258317086*^9, 3.591529345603106*^9, 3.591530935034066*^9, 
   3.591534571419037*^9, 3.591722067028467*^9, 3.939228329565929*^9, 
   3.942250645667316*^9, 3.942251802484533*^9, 3.942252475352558*^9, 
   3.942252605270096*^9, 3.942256149891679*^9, 3.942256564527794*^9, {
   3.942257265940795*^9, 3.942257271633344*^9}, 3.942257571946653*^9, {
   3.943118517203293*^9, 3.943118519731936*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"abbcb1b8-9a9d-4ac9-966c-661aa14b8786"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.591023692609852*^9, 3.591023715355994*^9}, {
   3.591026636609727*^9, 3.591026661270802*^9}, {3.591026940689095*^9, 
   3.591027001237807*^9}, {3.59135577018153*^9, 3.5913558170522633`*^9}, 
   3.591355852691101*^9, 3.591357771728786*^9, {3.59135818327808*^9, 
   3.59135819327138*^9}, 3.591358383227811*^9, {3.591358908132207*^9, 
   3.591358914317967*^9}, 3.591359424326515*^9, 3.591359507047414*^9, 
   3.591359633335654*^9, {3.5913597682488194`*^9, 3.5913597905044193`*^9}, 
   3.591361562915642*^9, 3.591362715401692*^9, 3.591363041791689*^9, 
   3.591365836067414*^9, 3.591365905055159*^9, 3.591366363971489*^9, 
   3.5913667094460287`*^9, 3.591368216052421*^9, 3.591371093835653*^9, 
   3.591372258317086*^9, 3.591529345603106*^9, 3.591530935034066*^9, 
   3.591534571419037*^9, 3.591722067028467*^9, 3.939228329565929*^9, 
   3.942250645667316*^9, 3.942251802484533*^9, 3.942252475352558*^9, 
   3.942252605270096*^9, 3.942256149891679*^9, 3.942256564527794*^9, {
   3.942257265940795*^9, 3.942257271633344*^9}, 3.942257571946653*^9, {
   3.943118517203293*^9, 3.943118520077241*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"5562d896-db14-499f-8891-d6207d935f80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "Gprime", " ", "and", " ", "G"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Gp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "*", "blob"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "0", ",", "R"}], "}"}]}], "]"}], "/", 
         RowBox[{"R", "^", "2"}]}], ")"}], "/.", 
       RowBox[{"R", "\[Rule]", "r"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"G", " ", "=", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{"Gp", ",", "r"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.591023727553304*^9, 3.591023750923484*^9}, {
  3.591024103467811*^9, 3.591024108819068*^9}, {3.591024159055532*^9, 
  3.591024165950324*^9}, {3.591026868443407*^9, 3.5910268755648537`*^9}, {
  3.591355885943778*^9, 3.59135592328865*^9}, {3.591357757027545*^9, 
  3.5913577610724096`*^9}, {3.591357791657141*^9, 3.591357826429934*^9}, {
  3.939228160318849*^9, 3.9392281785753603`*^9}, {3.942250992263797*^9, 
  3.9422509956374903`*^9}, {3.942257924620673*^9, 3.9422579368593802`*^9}, {
  3.9422580273156977`*^9, 3.942258029295227*^9}, {3.942258061202732*^9, 
  3.94225806360553*^9}, {3.942258241142593*^9, 3.942258253962352*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"c3618314-3830-43ad-8f78-7a2e36395aaf"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], " ", 
    SuperscriptBox["d", "2"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"]}]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.591023740063773*^9, 3.5910237513738813`*^9}, 
   3.591024124413887*^9, 3.591024167726256*^9, 3.591026666385794*^9, 
   3.5910268774597263`*^9, 3.591027027983862*^9, {3.591355825581019*^9, 
   3.591355888618483*^9}, {3.5913559198108044`*^9, 3.591355924561262*^9}, {
   3.591357776550965*^9, 3.591357802052985*^9}, 3.591358201779228*^9, 
   3.591358386185513*^9, 3.591358921435418*^9, 3.5913595105865993`*^9, 
   3.591359637689679*^9, {3.591359798298475*^9, 3.591359814419015*^9}, 
   3.5913615671992483`*^9, {3.591362720543027*^9, 3.591362736973366*^9}, 
   3.591363046136609*^9, 3.59136584039431*^9, 3.591365910543023*^9, 
   3.591366366723227*^9, 3.591366711527049*^9, 3.5913682170702744`*^9, 
   3.591372259332429*^9, 3.591529346614506*^9, 3.591530937185424*^9, 
   3.5915345724689636`*^9, 3.591722068131578*^9, 3.939228332852494*^9, 
   3.942250997604352*^9, 3.942251803820267*^9, 3.942252483322174*^9, 
   3.9422526066259823`*^9, 3.942256151223529*^9, 3.942256565903862*^9, 
   3.942256919439147*^9, 3.942257147615712*^9, 3.942257573280197*^9, 
   3.942257949775408*^9, 3.942258030768901*^9, 3.942258065175874*^9, 
   3.942258211220829*^9, {3.942258241775525*^9, 3.9422582553500757`*^9}, 
   3.9431185313611383`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"11467d85-f157-4276-8984-12a1e3db3448"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Bp", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", "G"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "R"}], "}"}]}], "]"}], "/", 
      RowBox[{"R", "^", "2"}]}], ")"}], "/.", 
    RowBox[{"R", "\[Rule]", "r"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"B", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Integrate", "[", 
    RowBox[{"Bp", ",", "r"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.59102375503051*^9, 3.591023756134664*^9}, {
  3.591024090220615*^9, 3.591024095885921*^9}, {3.591024199669353*^9, 
  3.5910242134458733`*^9}, {3.591357843591722*^9, 3.591357850653737*^9}, {
  3.591357958138764*^9, 3.59135796504992*^9}, {3.591358033854966*^9, 
  3.5913580874118967`*^9}, {3.591358133590899*^9, 3.591358134437687*^9}, {
  3.591358398709521*^9, 3.59135840546846*^9}, {3.942251012784733*^9, 
  3.94225101753113*^9}, {3.942252484486484*^9, 3.9422524845713367`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"06c7dc59-1183-461a-b9ff-087bd96f7ec5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["r", 
   RowBox[{"8", " ", "\[Pi]", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}]]}]]}]], "Output",
 CellChangeTimes->{{3.591024097257687*^9, 3.591024126838273*^9}, {
   3.591024176291611*^9, 3.591024214281371*^9}, 3.591026679592561*^9, 
   3.591026881024433*^9, 3.591027030340571*^9, 3.591355863554677*^9, 
   3.591357855452681*^9, 3.591357969316867*^9, {3.591358038483393*^9, 
   3.591358090776081*^9}, 3.591358138732832*^9, {3.591358374896022*^9, 
   3.591358407795876*^9}, 3.591358933874796*^9, 3.591359515339693*^9, 
   3.59135964507932*^9, 3.591359819405833*^9, 3.591361571382489*^9, {
   3.591362727165184*^9, 3.591362743746046*^9}, 3.591363051173035*^9, 
   3.59136584588852*^9, 3.5913659180576267`*^9, 3.591366370310389*^9, 
   3.591366715166707*^9, 3.591368219084478*^9, 3.591372261370219*^9, 
   3.5915293486504*^9, 3.5915309408922577`*^9, 3.591534574544733*^9, 
   3.591722070151415*^9, 3.939228337113104*^9, {3.942251035850677*^9, 
   3.942251038754476*^9}, 3.9422518064275928`*^9, 3.942252490574794*^9, 
   3.942252609240141*^9, 3.942256153842869*^9, 3.9422565685378532`*^9, 
   3.942257445517662*^9, 3.942257575872059*^9, {3.943118535035069*^9, 
   3.943118535551111*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"4b1652be-9d8e-4572-ae84-05a981405f64"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SqrtBox[
    RowBox[{
     SuperscriptBox["d", "2"], "+", 
     SuperscriptBox["r", "2"]}]], 
   RowBox[{"8", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{{3.591024097257687*^9, 3.591024126838273*^9}, {
   3.591024176291611*^9, 3.591024214281371*^9}, 3.591026679592561*^9, 
   3.591026881024433*^9, 3.591027030340571*^9, 3.591355863554677*^9, 
   3.591357855452681*^9, 3.591357969316867*^9, {3.591358038483393*^9, 
   3.591358090776081*^9}, 3.591358138732832*^9, {3.591358374896022*^9, 
   3.591358407795876*^9}, 3.591358933874796*^9, 3.591359515339693*^9, 
   3.59135964507932*^9, 3.591359819405833*^9, 3.591361571382489*^9, {
   3.591362727165184*^9, 3.591362743746046*^9}, 3.591363051173035*^9, 
   3.59136584588852*^9, 3.5913659180576267`*^9, 3.591366370310389*^9, 
   3.591366715166707*^9, 3.591368219084478*^9, 3.591372261370219*^9, 
   3.5915293486504*^9, 3.5915309408922577`*^9, 3.591534574544733*^9, 
   3.591722070151415*^9, 3.939228337113104*^9, {3.942251035850677*^9, 
   3.942251038754476*^9}, 3.9422518064275928`*^9, 3.942252490574794*^9, 
   3.942252609240141*^9, 3.942256153842869*^9, 3.9422565685378532`*^9, 
   3.942257445517662*^9, 3.942257575872059*^9, {3.943118535035069*^9, 
   3.943118535551601*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"32ad6d11-a025-4e34-963a-6e1259104749"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Bp", "/", "r"}], "-", "G"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"H2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", "*", 
       RowBox[{"D", "[", 
        RowBox[{"Bp", ",", "r"}], "]"}]}], "-", "Bp"}], ")"}], "/", 
    RowBox[{"r", "^", "3"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.591026566765295*^9, 3.59102658547031*^9}, {
  3.591026884610653*^9, 3.591026895314509*^9}, {3.591358329461168*^9, 
  3.591358330867344*^9}, {3.59135844732974*^9, 3.591358503808429*^9}, {
  3.591358611117036*^9, 3.591358703384371*^9}, {3.591358740376199*^9, 
  3.5913587440713377`*^9}, {3.591359000586769*^9, 3.591359014033242*^9}, {
  3.591359064612032*^9, 3.5913590704685097`*^9}, {3.591359126292639*^9, 
  3.591359126684319*^9}, {3.591359198665249*^9, 3.591359199473007*^9}, {
  3.591359233665451*^9, 3.591359257695705*^9}, {3.591359846836128*^9, 
  3.591359851035694*^9}, {3.942251134917873*^9, 3.942251187727811*^9}, {
  3.942251218985523*^9, 3.9422512201940403`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a0e8343f-cccc-46ee-a0f9-eaaa663d96ea"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    SuperscriptBox["d", "2"]}], "+", 
   SuperscriptBox["r", "2"]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.591026586070636*^9, 3.591026699029521*^9, 3.591026743778266*^9, 
   3.591026896742049*^9, 3.591027033391398*^9, 3.591356636244959*^9, 
   3.5913566715666018`*^9, {3.591358468537928*^9, 3.591358504339858*^9}, {
   3.591358621970262*^9, 3.59135865313834*^9}, 3.591358704257141*^9, 
   3.591358745253318*^9, 3.5913589389998484`*^9, 3.59135901484538*^9, 
   3.591359071291041*^9, 3.5913591282042003`*^9, 3.591359200547583*^9, {
   3.591359237857632*^9, 3.591359259314973*^9}, 3.591359519131898*^9, 
   3.59135964820184*^9, {3.591359822775703*^9, 3.5913598513558283`*^9}, 
   3.591361574579767*^9, 3.591362754460719*^9, 3.591363054420598*^9, 
   3.591365848894411*^9, {3.591365921508871*^9, 3.5913659281980133`*^9}, 
   3.5913663703815317`*^9, 3.591366715237813*^9, 3.591368219141333*^9, 
   3.591368268410898*^9, 3.591372261442849*^9, 3.591529348743678*^9, 
   3.591530940957701*^9, 3.591534574677236*^9, 3.591722070222217*^9, 
   3.939228339449442*^9, {3.942251136968647*^9, 3.9422511580568438`*^9}, 
   3.942251188213037*^9, 3.942251220434901*^9, 3.9422518064999747`*^9, 
   3.942252490709383*^9, 3.942252609305409*^9, 3.9422561539100027`*^9, 
   3.942256568610313*^9, 3.942257575940155*^9, 3.9431185393398542`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"76708e18-39e8-4768-8efe-b22889d69742"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.591026586070636*^9, 3.591026699029521*^9, 3.591026743778266*^9, 
   3.591026896742049*^9, 3.591027033391398*^9, 3.591356636244959*^9, 
   3.5913566715666018`*^9, {3.591358468537928*^9, 3.591358504339858*^9}, {
   3.591358621970262*^9, 3.59135865313834*^9}, 3.591358704257141*^9, 
   3.591358745253318*^9, 3.5913589389998484`*^9, 3.59135901484538*^9, 
   3.591359071291041*^9, 3.5913591282042003`*^9, 3.591359200547583*^9, {
   3.591359237857632*^9, 3.591359259314973*^9}, 3.591359519131898*^9, 
   3.59135964820184*^9, {3.591359822775703*^9, 3.5913598513558283`*^9}, 
   3.591361574579767*^9, 3.591362754460719*^9, 3.591363054420598*^9, 
   3.591365848894411*^9, {3.591365921508871*^9, 3.5913659281980133`*^9}, 
   3.5913663703815317`*^9, 3.591366715237813*^9, 3.591368219141333*^9, 
   3.591368268410898*^9, 3.591372261442849*^9, 3.591529348743678*^9, 
   3.591530940957701*^9, 3.591534574677236*^9, 3.591722070222217*^9, 
   3.939228339449442*^9, {3.942251136968647*^9, 3.9422511580568438`*^9}, 
   3.942251188213037*^9, 3.942251220434901*^9, 3.9422518064999747`*^9, 
   3.942252490709383*^9, 3.942252609305409*^9, 3.9422561539100027`*^9, 
   3.942256568610313*^9, 3.942257575940155*^9, 3.94311853934063*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"643ffc06-e995-4192-beb2-de6f1fdd4db9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"S1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"-", "Gp"}], "/", "r"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"S2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "*", 
         RowBox[{"D", "[", 
          RowBox[{"Gp", ",", "r"}], "]"}]}], "-", "Gp"}], ")"}]}], "/", 
     RowBox[{"r", "^", "3"}]}], ",", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"d", "^", "2"}], "+", 
      RowBox[{"r", "^", "2"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.591026587088207*^9, 3.591026599334121*^9}, {
   3.59102673918824*^9, 3.591026740699688*^9}, {3.591357907431354*^9, 
   3.591357914983127*^9}, 3.591358758073694*^9, {3.59135878807918*^9, 
   3.591358857638178*^9}, {3.591359366343965*^9, 3.591359377885057*^9}, {
   3.5913595514942102`*^9, 3.5913595558445663`*^9}, 3.5913681353822727`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"a7a4d664-dfdf-4b00-bb7b-bef5a2751059"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"5", " ", 
     SuperscriptBox["d", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "2"]}]}], 
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["d", "2"], "+", 
       SuperscriptBox["r", "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.5910265909092827`*^9, 3.591026600319053*^9}, 
   3.5910267017976*^9, 3.5910267459439*^9, 3.591027035194206*^9, 
   3.5913579154185*^9, {3.591358793909224*^9, 3.591358858294219*^9}, 
   3.591358942585009*^9, 3.591359267122078*^9, 3.5913593034460278`*^9, {
   3.591359368416045*^9, 3.5913593783267*^9}, 3.591359523250224*^9, 
   3.591359556434815*^9, 3.591359654259581*^9, 3.591361577213299*^9, 
   3.591362758564801*^9, 3.5913630577940893`*^9, 3.591365854500844*^9, 
   3.591365932650641*^9, 3.591366370415476*^9, 3.5913667152524652`*^9, 
   3.591368136765399*^9, 3.59136821915664*^9, 3.59137226147108*^9, 
   3.59152934877987*^9, 3.591530940994637*^9, 3.591534574762351*^9, 
   3.5917220702523336`*^9, 3.939228341856483*^9, 3.942251241460543*^9, 
   3.94225180650406*^9, 3.9422524952302723`*^9, 3.942252609314622*^9, 
   3.942256153918605*^9, 3.942256568613865*^9, 3.94225757594559*^9, 
   3.9431185416071587`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"247212e5-5b7c-4eaa-b57f-12d248f1b66b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      SuperscriptBox["d", "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["r", "2"]}]}], ")"}]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.5910265909092827`*^9, 3.591026600319053*^9}, 
   3.5910267017976*^9, 3.5910267459439*^9, 3.591027035194206*^9, 
   3.5913579154185*^9, {3.591358793909224*^9, 3.591358858294219*^9}, 
   3.591358942585009*^9, 3.591359267122078*^9, 3.5913593034460278`*^9, {
   3.591359368416045*^9, 3.5913593783267*^9}, 3.591359523250224*^9, 
   3.591359556434815*^9, 3.591359654259581*^9, 3.591361577213299*^9, 
   3.591362758564801*^9, 3.5913630577940893`*^9, 3.591365854500844*^9, 
   3.591365932650641*^9, 3.591366370415476*^9, 3.5913667152524652`*^9, 
   3.591368136765399*^9, 3.59136821915664*^9, 3.59137226147108*^9, 
   3.59152934877987*^9, 3.591530940994637*^9, 3.591534574762351*^9, 
   3.5917220702523336`*^9, 3.939228341856483*^9, 3.942251241460543*^9, 
   3.94225180650406*^9, 3.9422524952302723`*^9, 3.942252609314622*^9, 
   3.942256153918605*^9, 3.942256568613865*^9, 3.94225757594559*^9, 
   3.943118541622225*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"c3f1ad89-372d-4e02-981f-3e07bb773fd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["blob"], "Input",
 CellChangeTimes->{{3.59136775062852*^9, 3.591367751069915*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"99d2a7cf-9cc4-42a8-87ca-5c4b0edd0da7"],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", 
   SuperscriptBox["d", "4"]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.591367751748907*^9, 3.591368219341871*^9, 
  3.591372261721768*^9, 3.591529348980404*^9, 3.591530941206804*^9, 
  3.591534575175241*^9, 3.591722070469364*^9, 3.939228366974628*^9, 
  3.939228558084292*^9, 3.942251256396535*^9, 3.942251806515835*^9, 
  3.942252498551517*^9, 3.942252609324211*^9, 3.942256153930542*^9, 
  3.942256568628653*^9, 3.9422575759590483`*^9, 3.943118543564515*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"376f1f60-2c68-4ca9-99cd-a8d4f8f8493d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "For", " ", "the", " ", "spherical", " ", "membrane", " ", "problem", " ", 
    
    RowBox[{"(", 
     RowBox[{
     "parameterize", " ", "the", " ", "surface", " ", "using", " ", 
      "spherical", " ", "coordinates"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"evaluation", " ", "point", " ", "is", " ", 
     RowBox[{"(", 
      RowBox[{"xs", ",", "ys", ",", "zs"}], ")"}]}], "=", " ", 
    RowBox[{"(", 
     RowBox[{"R", ",", "0", ",", "0"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xs", " ", "=", " ", 
     RowBox[{"R", "*", 
      RowBox[{"Cos", "[", "0", "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"Pi", "/", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys", " ", "=", " ", 
     RowBox[{"R", "*", 
      RowBox[{"Sin", "[", "0", "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"Pi", "/", "2"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zs", " ", "=", " ", 
     RowBox[{"R", "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"Pi", "/", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"dGdx", " ", "=", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"G", ",", "r"}], "]"}], "*", 
     RowBox[{"x", "/", "r"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.591529354048691*^9, {3.591529795988648*^9, 3.591529859377352*^9}, {
   3.591529990038485*^9, 3.591529993821316*^9}, {3.591530395764969*^9, 
   3.5915303995876207`*^9}, {3.591531128848967*^9, 3.591531129234269*^9}, {
   3.59153116567142*^9, 3.59153118100071*^9}, {3.591531252373275*^9, 
   3.59153125873164*^9}, {3.939228219642166*^9, 3.939228263275093*^9}, {
   3.942251261104972*^9, 3.942251267771853*^9}, {3.942251356709601*^9, 
   3.9422514324017143`*^9}, {3.942252503454978*^9, 3.9422525044028187`*^9}, {
   3.943118547902169*^9, 3.943118564472151*^9}, {3.943118624716851*^9, 
   3.943118639795092*^9}},ExpressionUUID->"cd237bde-c4df-4cd1-84cc-\
16de3df9b53b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["d", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{"8", " ", "\[Pi]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["r", "2"]}], ")"}], 
         RowBox[{"5", "/", "2"}]]}]]}], "-", 
     FractionBox["r", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["r", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], ")"}], " ", "x"}], "r"]], "Output",
 CellChangeTimes->{
  3.591529354746239*^9, 3.5915298600458317`*^9, 3.591529951680264*^9, 
   3.591529994897005*^9, 3.59153040600651*^9, 3.591530941307206*^9, 
   3.591531130280233*^9, {3.5915311666165752`*^9, 3.591531181532965*^9}, 
   3.5915312617044363`*^9, 3.591534575324131*^9, 3.591722070572293*^9, 
   3.939228384978972*^9, 3.939228580919027*^9, {3.94225140395646*^9, 
   3.94225143301593*^9}, {3.942251782450433*^9, 3.942251806518326*^9}, 
   3.942252508708219*^9, 3.942252609335583*^9, 3.942256153933319*^9, 
   3.942256372503751*^9, 3.942256568631154*^9, 3.942257481704307*^9, 
   3.942257575961497*^9, {3.9431185731020517`*^9, 3.943118577471753*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"a76d8952-8345-4308-9fe7-2f187ef7fac1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"normal", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"theta", ",", "phi"}], ")"}], ".", "grad"}]}], ")"}], " ", 
    "applied", " ", "to", " ", "dGdx"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"dGdx", ",", "x"}], "]"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"dGdx", ",", "r"}], "]"}], "*", 
        RowBox[{"x", "/", "r"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"dGdx", ",", "y"}], "]"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"dGdx", ",", "r"}], "]"}], "*", 
        RowBox[{"y", "/", "r"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"dGdx", ",", "z"}], "]"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"dGdx", ",", "r"}], "]"}], "*", 
        RowBox[{"z", "/", "r"}]}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.591529405701644*^9, 3.591529441615672*^9}, {
  3.591529892351544*^9, 3.5915299483873053`*^9}, {3.939228276092214*^9, 
  3.939228304655793*^9}, {3.9392284507773*^9, 3.939228458534411*^9}, {
  3.942251456437627*^9, 3.9422515260423603`*^9}, {3.942252822783171*^9, 
  3.942252824854619*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"2495ccc2-8ebd-432d-9b2f-e97b31c00dcc"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"7", " ", 
       SuperscriptBox["d", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", "x", " ", "z", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", 
          SuperscriptBox["d", "4"]}], "+", 
         RowBox[{"7", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"7", " ", 
          SuperscriptBox["d", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", "x", " ", "y", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.591529443309018*^9, 3.59152960737328*^9, 3.591529953623623*^9, 
   3.591529997080625*^9, 3.5915300486376*^9, {3.5915301376002283`*^9, 
   3.591530156519624*^9}, 3.5915304123645678`*^9, {3.591530478921812*^9, 
   3.591530535302092*^9}, 3.591530636462054*^9, 3.591530845954841*^9, 
   3.591530941390229*^9, 3.5915311343698397`*^9, 3.5915311866211653`*^9, 
   3.59153126351589*^9, 3.591534575380837*^9, 3.591722070628626*^9, 
   3.9392283158894367`*^9, 3.939228388252734*^9, 3.939228462066074*^9, 
   3.939228589175546*^9, 3.94225152660952*^9, 3.942251775230578*^9, 
   3.942251806602478*^9, 3.942252516838861*^9, 3.942252609420154*^9, 
   3.942252875325333*^9, {3.9422561540169764`*^9, 3.942256174453087*^9}, {
   3.942256368698914*^9, 3.942256375162215*^9}, 3.9422564166768284`*^9, 
   3.942256568715288*^9, 3.942257576046454*^9, 3.943118582700942*^9, 
   3.9431186783521357`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"cfbdb6e8-babf-42a0-b440-4a3fa175ec0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"%", "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}]}], "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"xs", "-", 
        RowBox[{"R", "*", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ys", "-", 
        RowBox[{"R", "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"zs", "-", 
        RowBox[{"R", "*", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.591529464334641*^9, 3.591529482909465*^9}, {
   3.591529582722164*^9, 3.591529598416982*^9}, {3.59152997363316*^9, 
   3.591530044720183*^9}, {3.5915304308574347`*^9, 3.591530530901072*^9}, 
   3.591530632065072*^9, {3.59153084226718*^9, 3.591530852561736*^9}, {
   3.939228467581886*^9, 3.9392284743087*^9}, {3.942251536066358*^9, 
   3.94225160833493*^9}, {3.942251705158369*^9, 3.942251705671777*^9}, {
   3.9422517493002243`*^9, 3.942251749581771*^9}, {3.942252416662698*^9, 
   3.942252421765366*^9}, {3.942252530584841*^9, 3.942252532773532*^9}, {
   3.942252591657805*^9, 3.9422525947661242`*^9}, {3.9422561297589393`*^9, 
   3.942256130097064*^9}, {3.942256410048312*^9, 3.942256410631243*^9}, {
   3.9431186732511177`*^9, 3.943118673974992*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"f8b82264-cfeb-4e7b-a76a-2edf53d3b4cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"R", "-", 
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"7", " ", 
        SuperscriptBox["d", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["R", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["R", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "R", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"R", "-", 
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"7", " ", 
           SuperscriptBox["d", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["R", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["R", "2"], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["d", "4"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["R", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"3", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["R", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["R", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"R", "-", 
                 RowBox[{"R", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], "2"]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["d", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], 
     RowBox[{"7", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.942251750279479*^9, 3.942251807552083*^9, 3.9422524624909067`*^9, {
   3.942252521431055*^9, 3.942252533264913*^9}, 3.942252610383267*^9, {
   3.942256137467772*^9, 3.942256178025716*^9}, 3.942256378515359*^9, 
   3.942256418869764*^9, 3.942256569665107*^9, 3.9422574878515053`*^9, 
   3.942257576977634*^9, 3.943118586489161*^9, {3.943118676622592*^9, 
   3.9431186833187227`*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"2c62ee10-92af-406e-b94a-cf2bbc851b18"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "The", " ", "next", " ", "calculation", " ", "seems", " ", "to", " ", 
   "take", " ", 
   RowBox[{"forever", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943118751572597*^9, 
  3.9431187692763023`*^9}},ExpressionUUID->"203c47d9-cc66-460f-a766-\
e9356d50f3c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Upp", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "^", "2"}], "*", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", 
      RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.942256134236488*^9, 3.942256162700872*^9}, {
  3.9422563549876223`*^9, 3.942256358260553*^9}, {3.942257510523177*^9, 
  3.942257530545723*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"96697b16-448d-42c8-bba2-8c2823c74c1a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.942257909892005*^9, 3.943118745128746*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"9c39432c-904a-45a6-9f20-4b9d46d5cf27"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"d", "*", "Upp"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "4"}], "}"}]}], "]"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.591529746272094*^9, 3.591529759556583*^9}, {
  3.591530095341951*^9, 3.591530095828538*^9}, {3.591530164496016*^9, 
  3.591530170357725*^9}, {3.591530564797788*^9, 3.591530575405425*^9}, {
  3.591530612201413*^9, 3.591530612513369*^9}, {3.591530667476513*^9, 
  3.5915306676513786`*^9}, {3.591530768224406*^9, 3.591530768414212*^9}, {
  3.591530813405203*^9, 3.591530814805784*^9}, {3.94225243496461*^9, 
  3.942252437885651*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"05cf52c4-fc20-43ee-ac7b-d7be27efa6f9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"R", " ", "=", " ", "1"}], ";", " ", 
   RowBox[{"d", " ", "=", " ", "0.01"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.942256490180243*^9, 3.942256491925013*^9}, {
  3.9422566207198763`*^9, 3.9422566249924603`*^9}, {3.9422575219513073`*^9, 
  3.942257524291709*^9}},ExpressionUUID->"609de295-b939-4162-b656-\
f5df6af45228"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Upp", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "^", "2"}], "*", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", "f1"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.942256382684457*^9, 3.9422564264704437`*^9}, {
  3.942256495555809*^9, 3.9422565051160727`*^9}, {3.942257526337672*^9, 
  3.9422575287456408`*^9}},ExpressionUUID->"5ff3cd23-bdf8-446b-9ee1-\
223c2e5e405d"],

Cell[BoxData["0.49750000165649705`"], "Output",
 CellChangeTimes->{{3.942256388390388*^9, 3.942256395868946*^9}, 
   3.942256505982716*^9, 3.942256569822878*^9, 3.942256627405774*^9, {
   3.9422574937428827`*^9, 3.942257501333043*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"b042a5ca-86e3-4964-b1c1-1c6237e9274b"]
}, Open  ]]
},
ScreenStyleEnvironment->"Presentation",
WindowSize->{1474, 654},
WindowMargins->{{155, Automatic}, {Automatic, 111}},
Magnification:>0.75 Inherited,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"277ee2ca-4418-4ee1-bd60-5566d136919e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 261, 6, 39, "Text",ExpressionUUID->"a43b5442-a45a-4413-b6df-b22d03276a2d"],
Cell[CellGroupData[{
Cell[843, 30, 1481, 42, 158, "Input",ExpressionUUID->"dd7fd2bb-c35b-420d-a2a2-308ab2b5a6ee"],
Cell[2327, 74, 999, 18, 41, "Output",ExpressionUUID->"248b8735-80e2-4512-9a0a-3c39acb0e39c"],
Cell[3329, 94, 940, 16, 54, "Output",ExpressionUUID->"5b2bd135-bbba-465b-a3e8-afd3d675f6d8"],
Cell[4272, 112, 948, 16, 56, "Output",ExpressionUUID->"5931b11f-86d3-498b-bd65-1e2f3b44a515"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5257, 133, 2178, 64, 158, "Input",ExpressionUUID->"aaed460f-285d-47fe-bcc7-14eb7d858fe4"],
Cell[7438, 199, 1485, 27, 72, "Output",ExpressionUUID->"abbcb1b8-9a9d-4ac9-966c-661aa14b8786"],
Cell[8926, 228, 1222, 17, 41, "Output",ExpressionUUID->"5562d896-db14-499f-8891-d6207d935f80"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10185, 250, 1482, 32, 100, "Input",ExpressionUUID->"c3618314-3830-43ad-8f78-7a2e36395aaf"],
Cell[11670, 284, 1707, 33, 72, "Output",ExpressionUUID->"11467d85-f157-4276-8984-12a1e3db3448"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13414, 322, 1154, 25, 71, "Input",ExpressionUUID->"06c7dc59-1183-461a-b9ff-087bd96f7ec5"],
Cell[14571, 349, 1367, 24, 62, "Output",ExpressionUUID->"4b1652be-9d8e-4572-ae84-05a981405f64"],
Cell[15941, 375, 1353, 24, 64, "Output",ExpressionUUID->"32ad6d11-a025-4e34-963a-6e1259104749"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17331, 404, 1188, 24, 71, "Input",ExpressionUUID->"a0e8343f-cccc-46ee-a0f9-eaaa663d96ea"],
Cell[18522, 430, 1657, 31, 72, "Output",ExpressionUUID->"76708e18-39e8-4768-8efe-b22889d69742"],
Cell[20182, 463, 1556, 27, 67, "Output",ExpressionUUID->"643ffc06-e995-4192-beb2-de6f1fdd4db9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21775, 495, 1017, 25, 71, "Input",ExpressionUUID->"a7a4d664-dfdf-4b00-bb7b-bef5a2751059"],
Cell[22795, 522, 1411, 29, 72, "Output",ExpressionUUID->"247212e5-5b7c-4eaa-b57f-12d248f1b66b"],
Cell[24209, 553, 1436, 30, 75, "Output",ExpressionUUID->"c3f1ad89-372d-4e02-981f-3e07bb773fd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25682, 588, 174, 2, 41, "Input",ExpressionUUID->"99d2a7cf-9cc4-42a8-87ca-5c4b0edd0da7"],
Cell[25859, 592, 781, 17, 72, "Output",ExpressionUUID->"376f1f60-2c68-4ca9-99cd-a8d4f8f8493d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26677, 614, 2113, 53, 216, "Input",ExpressionUUID->"cd237bde-c4df-4cd1-84cc-16de3df9b53b"],
Cell[28793, 669, 1634, 40, 82, "Output",ExpressionUUID->"a76d8952-8345-4308-9fe7-2f187ef7fac1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30464, 714, 1783, 49, 100, "Input",ExpressionUUID->"2495ccc2-8ebd-432d-9b2f-e97b31c00dcc"],
Cell[32250, 765, 2586, 65, 75, "Output",ExpressionUUID->"cfbdb6e8-babf-42a0-b440-4a3fa175ec0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34873, 835, 1889, 44, 71, "Input",ExpressionUUID->"f8b82264-cfeb-4e7b-a76a-2edf53d3b4cc"],
Cell[36765, 881, 4151, 108, 141, "Output",ExpressionUUID->"2c62ee10-92af-406e-b94a-cf2bbc851b18"]
}, Open  ]],
Cell[40931, 992, 312, 8, 41, "Input",ExpressionUUID->"203c47d9-cc66-460f-a766-e9356d50f3c5"],
Cell[CellGroupData[{
Cell[41268, 1004, 631, 15, 41, "Input",ExpressionUUID->"96697b16-448d-42c8-bba2-8c2823c74c1a"],
Cell[41902, 1021, 178, 2, 41, "Output",ExpressionUUID->"9c39432c-904a-45a6-9f20-4b9d46d5cf27"]
}, Open  ]],
Cell[42095, 1026, 771, 16, 41, "Input",ExpressionUUID->"05cf52c4-fc20-43ee-ac7b-d7be27efa6f9"],
Cell[42869, 1044, 382, 8, 41, "Input",ExpressionUUID->"609de295-b939-4162-b656-f5df6af45228"],
Cell[CellGroupData[{
Cell[43276, 1056, 650, 16, 41, "Input",ExpressionUUID->"5ff3cd23-bdf8-446b-9ee1-223c2e5e405d"],
Cell[43929, 1074, 314, 4, 41, "Output",ExpressionUUID->"b042a5ca-86e3-4964-b1c1-1c6237e9274b"]
}, Open  ]]
}
]
*)

